---
title: Uaktualnianie z poprzedniej wersji do programu EF Core 2 - programu EF Core
author: divega
ms.date: 08/13/2017
ms.assetid: 8BD43C8C-63D9-4F3A-B954-7BC518A1B7DB
uid: core/miscellaneous/1x-2x-upgrade
ms.openlocfilehash: 5371c8f3b7c6102c621296bbae145d13779e0c6e
ms.sourcegitcommit: 269c8a1a457a9ad27b4026c22c4b1a76991fb360
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/18/2018
ms.locfileid: "46283774"
---
# <a name="upgrading-applications-from-previous-versions-to-ef-core-20"></a><span data-ttu-id="c3fb8-102">Uaktualnianie aplikacji z poprzedniej wersji do programu EF Core 2.0</span><span class="sxs-lookup"><span data-stu-id="c3fb8-102">Upgrading applications from previous versions to EF Core 2.0</span></span>

<span data-ttu-id="c3fb8-103">Podejmujemy szansy sprzedaży, aby znacznie udoskonalić naszych istniejących interfejsów API i zachowań w wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-103">We have taken the opportunity to significantly refine our existing APIs and behaviors in 2.0.</span></span> <span data-ttu-id="c3fb8-104">Istnieje kilka ulepszeń, które mogą wymagać od modyfikowania istniejącego kodu aplikacji, ale uważamy, że dla większości aplikacji wpływ będzie niska, w większości przypadków wymaga podania tylko ponownej kompilacji i minimalnych zmianach z przewodnikiem, aby zastąpić przestarzałe interfejsy API.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-104">There are a few improvements that can require modifying existing application code, although we believe that for the majority of applications the impact will be low, in most cases requiring just recompilation and minimal guided changes to replace obsolete APIs.</span></span>

<span data-ttu-id="c3fb8-105">Aktualizowanie istniejącej aplikacji do programu EF Core 2.0 mogą wymagać:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-105">Updating an existing application to EF Core 2.0 may require:</span></span>

1. <span data-ttu-id="c3fb8-106">Uaktualnianie wdrożenia .NET docelowej aplikacji obsługującej .NET Standard 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-106">Upgrading the target .NET implementation of the application to one that supports .NET Standard 2.0.</span></span> <span data-ttu-id="c3fb8-107">Zobacz [obsługiwane implementacje platformy .NET](../platforms/index.md) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-107">See [Supported .NET Implementations](../platforms/index.md) for more details.</span></span>

2. <span data-ttu-id="c3fb8-108">Określ dostawcę dla docelowej bazy danych, które są zgodne z programem EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-108">Identify a provider for the target database which is compatible with EF Core 2.0.</span></span> <span data-ttu-id="c3fb8-109">Zobacz [EF Core 2.0 wymaga dostawcy bazy danych 2.0](#ef-core-20-requires-a-20-database-provider) poniżej.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-109">See [EF Core 2.0 requires a 2.0 database provider](#ef-core-20-requires-a-20-database-provider) below.</span></span>

3. <span data-ttu-id="c3fb8-110">Uaktualnienie wszystkich pakietów programu EF Core (środowiska uruchomieniowego i narzędzi) do wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-110">Upgrading all the EF Core packages (runtime and tooling) to 2.0.</span></span> <span data-ttu-id="c3fb8-111">Zapoznaj się [Instalowanie programu EF Core](../get-started/install/index.md) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-111">Refer to [Installing EF Core](../get-started/install/index.md) for more details.</span></span>

4. <span data-ttu-id="c3fb8-112">Wprowadź wszelkie zmiany niezbędny kod w celu kompensacji przełomowe zmiany opisane w dalszej części tego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-112">Make any necessary code changes to compensate for the breaking changes described in the rest of this document.</span></span>

## <a name="aspnet-core-now-includes-ef-core"></a><span data-ttu-id="c3fb8-113">Platforma ASP.NET Core zawiera teraz EF Core</span><span class="sxs-lookup"><span data-stu-id="c3fb8-113">ASP.NET Core now includes EF Core</span></span>

<span data-ttu-id="c3fb8-114">Aplikacje przeznaczone na platformy ASP.NET Core 2.0 mogą używać programu EF Core 2.0 bez dodatkowe zależności oprócz dostawcy bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-114">Applications targeting ASP.NET Core 2.0 can use EF Core 2.0 without additional dependencies besides third party database providers.</span></span> <span data-ttu-id="c3fb8-115">Jednak aplikacje przeznaczone na poprzednie wersje platformy ASP.NET Core konieczne uaktualnienie do programu ASP.NET Core 2.0, aby można było używać programu EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-115">However, applications targeting previous versions of ASP.NET Core need to upgrade to ASP.NET Core 2.0 in order to use EF Core 2.0.</span></span> <span data-ttu-id="c3fb8-116">Aby uzyskać więcej informacji na temat uaktualniania aplikacji platformy ASP.NET Core 2.0, zobacz [dokumentacji platformy ASP.NET Core na ten temat](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-116">For more details on upgrading ASP.NET Core applications to 2.0 see [the ASP.NET Core documentation on the subject](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span></span>

## <a name="new-way-of-getting-application-services-in-aspnet-core"></a><span data-ttu-id="c3fb8-117">Nowy sposób, w jakim usługi aplikacji w programie ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c3fb8-117">New way of getting application services in ASP.NET Core</span></span>

<span data-ttu-id="c3fb8-118">Zaktualizowano zalecany wzorzec dla aplikacji sieci web platformy ASP.NET Core 2.0 w taki sposób, że Przerwano logiki czasu projektowania, jakie programu EF Core w 1.x.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-118">The recommended pattern for ASP.NET Core web applications has been updated for 2.0 in a way that broke the design-time logic EF Core used in 1.x.</span></span> <span data-ttu-id="c3fb8-119">Wcześniej w czasie projektowania programu EF Core będzie spróbować ponownie wywołać `Startup.ConfigureServices` bezpośrednio po to, aby uzyskać dostęp do aplikacji dostawcy usług.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-119">Previously at design-time, EF Core would try to invoke `Startup.ConfigureServices` directly in order to access the application's service provider.</span></span> <span data-ttu-id="c3fb8-120">W programie ASP.NET Core 2.0 konfiguracji jest inicjowany poza `Startup` klasy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-120">In ASP.NET Core 2.0, Configuration is initialized outside of the `Startup` class.</span></span> <span data-ttu-id="c3fb8-121">Aplikacje zazwyczaj przy użyciu programu EF Core uzyskiwać dostęp do swoich parametrów połączenia z konfiguracji, więc `Startup` przez siebie nie jest już wystarczająca.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-121">Applications using EF Core typically access their connection string from Configuration, so `Startup` by itself is no longer sufficient.</span></span> <span data-ttu-id="c3fb8-122">Jeśli zaktualizujesz aplikację ASP.NET Core 1.x, otrzymasz następujący błąd podczas korzystania z narzędzi programu EF Core.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-122">If you upgrade an ASP.NET Core 1.x application, you may receive the following error when using the EF Core tools.</span></span>

> <span data-ttu-id="c3fb8-123">Żaden konstruktor bez parametrów nie został odnaleziony w "ApplicationContext".</span><span class="sxs-lookup"><span data-stu-id="c3fb8-123">No parameterless constructor was found on 'ApplicationContext'.</span></span> <span data-ttu-id="c3fb8-124">Dodaj konstruktor bez parametrów do "ApplicationContext" lub Dodaj implementację "IDesignTimeDbContextFactory&lt;ApplicationContext&gt;" z tego samego zestawu jako "ApplicationContext"</span><span class="sxs-lookup"><span data-stu-id="c3fb8-124">Either add a parameterless constructor to 'ApplicationContext' or add an implementation of 'IDesignTimeDbContextFactory&lt;ApplicationContext&gt;' in the same assembly as 'ApplicationContext'</span></span>

<span data-ttu-id="c3fb8-125">Nowe hook czasu projektowania został dodany w szablonie domyślnego programu ASP.NET Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-125">A new design-time hook has been added in ASP.NET Core 2.0's default template.</span></span> <span data-ttu-id="c3fb8-126">Statyczne `Program.BuildWebHost` metoda umożliwia programu EF Core dostępu do aplikacji usługi dostawcy w czasie projektowania.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-126">The static `Program.BuildWebHost` method enables EF Core to access the application's service provider at design time.</span></span> <span data-ttu-id="c3fb8-127">Jeśli uaktualniasz aplikacji ASP.NET Core 1.x należy zaktualizować `Program` klasy na podobny do następującego.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-127">If you are upgrading an ASP.NET Core 1.x application, you will need to update the `Program` class to resemble the following.</span></span>

``` csharp
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;

namespace AspNetCoreDotNetCore2._0App
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =>
            WebHost.CreateDefaultBuilder(args)
                .UseStartup<Startup>()
                .Build();
    }
}
```

<span data-ttu-id="c3fb8-128">Przyjęcie tego nowego wzorca podczas aktualizowania aplikacji w wersji 2.0 zdecydowanie zaleca się i jest wymagane dla funkcji produktów, takich jak migracje Entity Framework Core pracować.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-128">The adoption of this new pattern when updating applications to 2.0 is highly recommended and is required in order for product features like Entity Framework Core Migrations to work.</span></span> <span data-ttu-id="c3fb8-129">Powszechną alternatywą jest [zaimplementować *IDesignTimeDbContextFactory\<TContext >*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-129">The other common alternative is to [implement *IDesignTimeDbContextFactory\<TContext>*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span></span>

## <a name="idbcontextfactory-renamed"></a><span data-ttu-id="c3fb8-130">Zmieniono nazwę IDbContextFactory</span><span class="sxs-lookup"><span data-stu-id="c3fb8-130">IDbContextFactory renamed</span></span>

<span data-ttu-id="c3fb8-131">W celu obsługi wzorców dla różnych aplikacji i udostępniać użytkownikom większą kontrolę nad jak ich `DbContext` jest używany w czasie projektowania, mamy, w przeszłości, pod warunkiem `IDbContextFactory<TContext>` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-131">In order to support diverse application patterns and give users more control over how their `DbContext` is used at design time, we have, in the past, provided the `IDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="c3fb8-132">W czasie projektowania, narzędzi programu EF Core odnajdzie implementacje tego interfejsu w projekcie i użyć go do utworzenia `DbContext` obiektów.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-132">At design-time, the EF Core tools will discover implementations of this interface in your project and use it to create `DbContext` objects.</span></span>

<span data-ttu-id="c3fb8-133">Ten interfejs ma bardzo ogólne nazwy, która wprowadzać w błąd niektórych użytkowników, aby spróbować ponownie go dla innych `DbContext`— tworzenie scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-133">This interface had a very general name which mislead some users to try re-using it for other `DbContext`-creating scenarios.</span></span> <span data-ttu-id="c3fb8-134">Były one przechwytywane wyłączona ochrona, gdy narzędzia EF następnie dotarła do ich wykonania w czasie projektowania i spowodowane poleceń, takich jak `Update-Database` lub `dotnet ef database update` nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-134">They were caught off guard when the EF Tools then tried to use their implementation at design-time and caused commands like `Update-Database` or `dotnet ef database update` to fail.</span></span>

<span data-ttu-id="c3fb8-135">Aby komunikować się z silną semantyką czasu projektowania tego interfejsu, zmieniono jego `IDesignTimeDbContextFactory<TContext>`.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-135">In order to communicate the strong design-time semantics of this interface, we have renamed it to `IDesignTimeDbContextFactory<TContext>`.</span></span>

<span data-ttu-id="c3fb8-136">Dla wersji 2.0 wersji `IDbContextFactory<TContext>` nadal istnieje, ale jest oznaczony jako przestarzały.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-136">For the 2.0 release the `IDbContextFactory<TContext>` still exists but is marked as obsolete.</span></span>

## <a name="dbcontextfactoryoptions-removed"></a><span data-ttu-id="c3fb8-137">DbContextFactoryOptions usunięte</span><span class="sxs-lookup"><span data-stu-id="c3fb8-137">DbContextFactoryOptions removed</span></span>

<span data-ttu-id="c3fb8-138">Ze względu na zmiany ASP.NET Core 2.0, opisane powyżej, Odkryliśmy, że `DbContextFactoryOptions` został nie będą już potrzebne w nowym `IDesignTimeDbContextFactory<TContext>` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-138">Because of the ASP.NET Core 2.0 changes described above, we found that `DbContextFactoryOptions` was no longer needed on the new `IDesignTimeDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="c3fb8-139">Poniżej przedstawiono rozwiązań alternatywnych, z których powinien być używany zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-139">Here are the alternatives you should be using instead.</span></span>

| <span data-ttu-id="c3fb8-140">DbContextFactoryOptions</span><span class="sxs-lookup"><span data-stu-id="c3fb8-140">DbContextFactoryOptions</span></span> | <span data-ttu-id="c3fb8-141">Alternatywna</span><span class="sxs-lookup"><span data-stu-id="c3fb8-141">Alternative</span></span>                                                  |
|:------------------------|:-------------------------------------------------------------|
| <span data-ttu-id="c3fb8-142">ApplicationBasePath</span><span class="sxs-lookup"><span data-stu-id="c3fb8-142">ApplicationBasePath</span></span>     | <span data-ttu-id="c3fb8-143">AppContext.BaseDirectory</span><span class="sxs-lookup"><span data-stu-id="c3fb8-143">AppContext.BaseDirectory</span></span>                                     |
| <span data-ttu-id="c3fb8-144">ContentRootPath</span><span class="sxs-lookup"><span data-stu-id="c3fb8-144">ContentRootPath</span></span>         | <span data-ttu-id="c3fb8-145">Directory.GetCurrentDirectory()</span><span class="sxs-lookup"><span data-stu-id="c3fb8-145">Directory.GetCurrentDirectory()</span></span>                              |
| <span data-ttu-id="c3fb8-146">EnvironmentName</span><span class="sxs-lookup"><span data-stu-id="c3fb8-146">EnvironmentName</span></span>         | <span data-ttu-id="c3fb8-147">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span><span class="sxs-lookup"><span data-stu-id="c3fb8-147">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span></span> |

## <a name="design-time-working-directory-changed"></a><span data-ttu-id="c3fb8-148">Katalog roboczy czasu projektowania został zmieniony</span><span class="sxs-lookup"><span data-stu-id="c3fb8-148">Design-time working directory changed</span></span>

<span data-ttu-id="c3fb8-149">Katalog roboczy używany przez również wymaganych zmian platformy ASP.NET Core 2.0 `dotnet ef` wyrównać katalog roboczy używany przez program Visual Studio, podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-149">The ASP.NET Core 2.0 changes also required the working directory used by `dotnet ef` to align with the working directory used by Visual Studio when running your application.</span></span> <span data-ttu-id="c3fb8-150">Jeden dostrzegalnych efekt uboczny tej jest tej bazy danych SQLite nazwy plików są teraz względem katalogu projektu, a nie katalog wyjściowy jak kiedyś.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-150">One observable side effect of this is that SQLite filenames are now relative to the project directory and not the output directory like they used to be.</span></span>

## <a name="ef-core-20-requires-a-20-database-provider"></a><span data-ttu-id="c3fb8-151">EF Core 2.0 wymaga dostawcy 2.0 bazy danych</span><span class="sxs-lookup"><span data-stu-id="c3fb8-151">EF Core 2.0 requires a 2.0 database provider</span></span>

<span data-ttu-id="c3fb8-152">EF Core 2.0 wprowadzono wiele definiowaniu i ulepszeń w dostawcy baz danych w sposób pracy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-152">For EF Core 2.0 we have made many simplifications and improvements in the way database providers work.</span></span> <span data-ttu-id="c3fb8-153">Oznacza to, że dostawcy 1.0.x i 1.1.x, nie będą działać przy użyciu programu EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-153">This means that 1.0.x and 1.1.x providers will not work with EF Core 2.0.</span></span>

<span data-ttu-id="c3fb8-154">Dostawcy programu SQL Server i bazy danych SQLite są dostarczane przez zespół programu EF i wersji 2.0 będzie dostępna w wersji 2.0 w ramach wersji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-154">The SQL Server and SQLite providers are shipped by the EF team and 2.0 versions will be available as part of the 2.0 release.</span></span> <span data-ttu-id="c3fb8-155">Dostawcy typu open-source innych firm dla [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), i [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) są aktualizowane dla wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-155">The open-source third party providers for [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), and [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) are being updated for 2.0.</span></span> <span data-ttu-id="c3fb8-156">W przypadku innych dostawców, skontaktuj się z modułu zapisującego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-156">For all other providers, please contact the provider writer.</span></span>

## <a name="logging-and-diagnostics-events-have-changed"></a><span data-ttu-id="c3fb8-157">Zmieniono zdarzenia rejestrowania i diagnostyki</span><span class="sxs-lookup"><span data-stu-id="c3fb8-157">Logging and Diagnostics events have changed</span></span>

<span data-ttu-id="c3fb8-158">Uwaga: te zmiany nie powinien wpływać na większość kodu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-158">Note: these changes should not impact most application code.</span></span>

<span data-ttu-id="c3fb8-159">Komunikaty wysyłane do identyfikatorów zdarzeń [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) zostały zmienione w wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-159">The event IDs for messages sent to an [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) have changed in 2.0.</span></span> <span data-ttu-id="c3fb8-160">Identyfikatory zdarzeń obecnie są unikatowe w obrębie kod programem EF Core.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-160">The event IDs are now unique across EF Core code.</span></span> <span data-ttu-id="c3fb8-161">Te komunikaty teraz również wykonać standardowego wzorca dla rejestrowaniem strukturalnym używane przez, na przykład MVC.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-161">These messages now also follow the standard pattern for structured logging used by, for example, MVC.</span></span>

<span data-ttu-id="c3fb8-162">Kategorie rejestratora również zostały zmienione.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-162">Logger categories have also changed.</span></span> <span data-ttu-id="c3fb8-163">Ma teraz dobrze znanego zestawu kategorii dostępne za pośrednictwem [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-163">There is now a well-known set of categories accessed through [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs).</span></span>

<span data-ttu-id="c3fb8-164">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) zdarzenia teraz użyć takich samych nazwach identyfikator zdarzenia odpowiadającego `ILogger` wiadomości.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-164">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) events now use the same event ID names as the corresponding `ILogger` messages.</span></span> <span data-ttu-id="c3fb8-165">Ładunki zdarzeń są wszystkie typy nominalna pochodną [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-165">The event payloads are all nominal types derived from [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span></span>

<span data-ttu-id="c3fb8-166">Identyfikatory zdarzeń, typy ładunku i kategorie są udokumentowane w [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) i [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) klasy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-166">Event IDs, payload types, and categories are documented in the [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) and the [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) classes.</span></span>

<span data-ttu-id="c3fb8-167">Identyfikatory również zostały przeniesione z Microsoft.EntityFrameworkCore.Infraestructure do nowej przestrzeni nazw Microsoft.EntityFrameworkCore.Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-167">IDs have also moved from Microsoft.EntityFrameworkCore.Infraestructure to the new Microsoft.EntityFrameworkCore.Diagnostics namespace.</span></span>

## <a name="ef-core-relational-metadata-api-changes"></a><span data-ttu-id="c3fb8-168">EF Core relacyjnych metadanych interfejsu API zmiany</span><span class="sxs-lookup"><span data-stu-id="c3fb8-168">EF Core relational metadata API changes</span></span>

<span data-ttu-id="c3fb8-169">EF Core 2.0 będą teraz tworzyć inną [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs) dla każdego innego dostawcy używane.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-169">EF Core 2.0 will now build a different [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs) for each different provider being used.</span></span> <span data-ttu-id="c3fb8-170">Jest to zazwyczaj niewidoczna dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-170">This is usually transparent to the application.</span></span> <span data-ttu-id="c3fb8-171">Ma to ułatwione uproszczenia metadanych niskiego poziomu interfejsy API, taki sposób, że dowolny dostęp do _typowe pojęcia relacyjnych metadanych_ zawsze jest wykonywane za pomocą wywołania `.Relational` zamiast `.SqlServer`, `.Sqlite`itp. Na przykład 1.1.x kod następująco:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-171">This has facilitated a simplification of lower-level metadata APIs such that any access to _common relational metadata concepts_ is always made through a call to `.Relational` instead of `.SqlServer`, `.Sqlite`, etc. For example, 1.1.x code like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).SqlServer().TableName;
```

<span data-ttu-id="c3fb8-172">Powinny teraz być zapisany jako:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-172">Should now be written like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).Relational().TableName;
```

<span data-ttu-id="c3fb8-173">Zamiast używać metod, takich jak `ForSqlServerToTable`, metody rozszerzające są teraz dostępne do zapisu kod warunkowy, w oparciu o bieżący Dostawca używany.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-173">Instead of using methods like `ForSqlServerToTable`, extension methods are now available to write conditional code based on the current provider in use.</span></span> <span data-ttu-id="c3fb8-174">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-174">For example:</span></span>

```C#
modelBuilder.Entity<User>().ToTable(
    Database.IsSqlServer() ? "SqlServerName" : "OtherName");
```

<span data-ttu-id="c3fb8-175">Należy zauważyć, że ta zmiana ma zastosowanie tylko do interfejsów API/metadanych, który jest zdefiniowany dla _wszystkich_ relacyjnych dostawców.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-175">Note that this change only applies to APIs/metadata that is defined for _all_ relational providers.</span></span> <span data-ttu-id="c3fb8-176">Interfejs API i metadanych pozostaje taki sam, gdy jest ona specyficzne dla tylko jednego dostawcę.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-176">The API and metadata remains the same when it is specific to only a single provider.</span></span> <span data-ttu-id="c3fb8-177">Na przykład klastrowanych indeksów są specyficzne dla SQL Server, dzięki czemu `ForSqlServerIsClustered` i `.SqlServer().IsClustered()` nadal muszą być używane.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-177">For example, clustered indexes are specific to SQL Sever, so `ForSqlServerIsClustered` and  `.SqlServer().IsClustered()` must still be used.</span></span>

## <a name="dont-take-control-of-the-ef-service-provider"></a><span data-ttu-id="c3fb8-178">Nie przejąć kontrolę nad EF dostawcy usług</span><span class="sxs-lookup"><span data-stu-id="c3fb8-178">Don’t take control of the EF service provider</span></span>

<span data-ttu-id="c3fb8-179">EF Core używa wewnętrznego `IServiceProvider` (kontener iniekcji zależności) do swojej wewnętrznej implementacji.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-179">EF Core uses an internal `IServiceProvider` (a dependency injection container) for its internal implementation.</span></span> <span data-ttu-id="c3fb8-180">Aplikacje powinny zezwalać programu EF Core utworzyć i zarządzać tego dostawcy, z wyjątkiem w szczególnych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-180">Applications should allow EF Core to create and manage this provider except in special cases.</span></span> <span data-ttu-id="c3fb8-181">Zdecydowanie rozważyć usunięcie wszelkie wywołania `UseInternalServiceProvider`.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-181">Strongly consider removing any calls to `UseInternalServiceProvider`.</span></span> <span data-ttu-id="c3fb8-182">Jeśli aplikacja musi wywołać `UseInternalServiceProvider`, należy rozważyć [rejestrując problem](https://github.com/aspnet/EntityFramework/Issues) , dzięki czemu firma Microsoft można zbadać inne sposoby obsługi danego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-182">If an application does need to call `UseInternalServiceProvider`, then please consider [filing an issue](https://github.com/aspnet/EntityFramework/Issues) so we can investigate other ways to handle your scenario.</span></span>

<span data-ttu-id="c3fb8-183">Wywoływanie `AddEntityFramework`, `AddEntityFrameworkSqlServer`, itp. nie jest wymagane przez kod aplikacji, chyba że `UseInternalServiceProvider` skrót.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-183">Calling `AddEntityFramework`, `AddEntityFrameworkSqlServer`, etc. is not required by application code unless `UseInternalServiceProvider` is also called.</span></span> <span data-ttu-id="c3fb8-184">Usuń wszystkie istniejące wywołania `AddEntityFramework` lub `AddEntityFrameworkSqlServer`itd `AddDbContext` należy nadal używać w taki sam sposób jak wcześniej.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-184">Remove any existing calls to `AddEntityFramework` or `AddEntityFrameworkSqlServer`, etc. `AddDbContext` should still be used in the same way as before.</span></span>

## <a name="in-memory-databases-must-be-named"></a><span data-ttu-id="c3fb8-185">Musi mieć nazwę bazy danych w pamięci</span><span class="sxs-lookup"><span data-stu-id="c3fb8-185">In-memory databases must be named</span></span>

<span data-ttu-id="c3fb8-186">Globalne bez nazwy bazy danych w pamięci została usunięta, a zamiast tego muszą nosić wszystkich baz danych w pamięci.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-186">The global unnamed in-memory database has been removed and instead all in-memory databases must be named.</span></span> <span data-ttu-id="c3fb8-187">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-187">For example:</span></span>

``` csharp
optionsBuilder.UseInMemoryDatabase("MyDatabase");
```

<span data-ttu-id="c3fb8-188">To tworzy/używa bazy danych o nazwie "Moja_baza_danych".</span><span class="sxs-lookup"><span data-stu-id="c3fb8-188">This creates/uses a database with the name “MyDatabase”.</span></span> <span data-ttu-id="c3fb8-189">Jeśli `UseInMemoryDatabase` wywoływana jest ponownie o takiej samej nazwie tej samej bazy danych w pamięci zostanie użyta, dzięki któremu być współużytkowane przez wiele wystąpień kontekstu.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-189">If `UseInMemoryDatabase` is called again with the same name, then the same in-memory database will be used, allowing it to be shared by multiple context instances.</span></span>

## <a name="read-only-api-changes"></a><span data-ttu-id="c3fb8-190">Zmiany interfejsu API tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="c3fb8-190">Read-only API changes</span></span>

<span data-ttu-id="c3fb8-191">`IsReadOnlyBeforeSave`, `IsReadOnlyAfterSave`, i `IsStoreGeneratedAlways` zdezaktualizowane i zastąpione [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) i [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-191">`IsReadOnlyBeforeSave`, `IsReadOnlyAfterSave`, and `IsStoreGeneratedAlways` have been obsoleted and replaced with [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) and [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span></span> <span data-ttu-id="c3fb8-192">Te zachowania mają zastosowanie do wszystkich właściwości (nie tylko generowane przez Magazyn właściwości) i określić, jak wartość właściwości powinna być używana w przypadku wstawiania do wiersza bazy danych (`BeforeSaveBehavior`) lub podczas aktualizowania istniejącej bazy danych wiersza (`AfterSaveBehavior`).</span><span class="sxs-lookup"><span data-stu-id="c3fb8-192">These behaviors apply to any property (not only store-generated properties) and determine how the value of the property should be used when inserting into a database row (`BeforeSaveBehavior`) or when updating an existing database row (`AfterSaveBehavior`).</span></span>

<span data-ttu-id="c3fb8-193">Właściwości są oznaczone jako [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (na przykład w przypadku kolumn obliczanych) domyślnie zignoruje dowolną wartość aktualnie ustawiona we właściwości.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-193">Properties marked as [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (for example, for computed columns) will by default ignore any value currently set on the property.</span></span> <span data-ttu-id="c3fb8-194">Oznacza to, że wygenerowana przez Magazyn wartość, zawsze można uzyskać niezależnie od tego, czy dowolną wartość ma ustawić lub zmodyfikować śledzonych jednostki.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-194">This means that a store-generated value will always be obtained regardless of whether any value has been set or modified on the tracked entity.</span></span> <span data-ttu-id="c3fb8-195">Można to zmienić, ustawiając inną `Before\AfterSaveBehavior`.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-195">This can be changed by setting a different `Before\AfterSaveBehavior`.</span></span>

## <a name="new-clientsetnull-delete-behavior"></a><span data-ttu-id="c3fb8-196">Nowe zachowanie dotyczące usuwania ClientSetNull</span><span class="sxs-lookup"><span data-stu-id="c3fb8-196">New ClientSetNull delete behavior</span></span>

<span data-ttu-id="c3fb8-197">W poprzednich wersjach [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) miał zachowanie w przypadku jednostek śledzone przez kontekst, jeden zamknięty dopasowane `SetNull` semantyki.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-197">In previous releases, [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) had a behavior for entities tracked by the context that more closed matched `SetNull` semantics.</span></span> <span data-ttu-id="c3fb8-198">W programie EF Core 2.0 nową `ClientSetNull` zachowanie została wprowadzona jako domyślne dla relacji opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-198">In EF Core 2.0, a new `ClientSetNull` behavior has been introduced as the default for optional relationships.</span></span> <span data-ttu-id="c3fb8-199">To zachowanie ma `SetNull` semantyki śledzonych jednostek i `Restrict` zachowanie dla baz danych utworzonych przy użyciu programu EF Core.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-199">This behavior has `SetNull` semantics for tracked entities and `Restrict` behavior for databases created using EF Core.</span></span> <span data-ttu-id="c3fb8-200">W naszych doświadczeń wynika są to najbardziej oczekiwano/przydatne zachowania dla jednostek śledzone i bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-200">In our experience, these are the most expected/useful behaviors for tracked entities and the database.</span></span> <span data-ttu-id="c3fb8-201">`DeleteBehavior.Restrict` teraz zostanie uznane dla obiektów śledzonych dla relacji opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-201">`DeleteBehavior.Restrict` is now honored for tracked entities when set for optional relationships.</span></span>

## <a name="provider-design-time-packages-removed"></a><span data-ttu-id="c3fb8-202">Dostawca czasu projektowania pakietów usunięte</span><span class="sxs-lookup"><span data-stu-id="c3fb8-202">Provider design-time packages removed</span></span>

<span data-ttu-id="c3fb8-203">`Microsoft.EntityFrameworkCore.Relational.Design` Pakiet został usunięty.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-203">The `Microsoft.EntityFrameworkCore.Relational.Design` package has been removed.</span></span> <span data-ttu-id="c3fb8-204">Jego zawartości zostały skonsolidowane w `Microsoft.EntityFrameworkCore.Relational` i `Microsoft.EntityFrameworkCore.Design`.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-204">It's contents were consolidated into `Microsoft.EntityFrameworkCore.Relational` and `Microsoft.EntityFrameworkCore.Design`.</span></span>

<span data-ttu-id="c3fb8-205">Propaguje to do pakietów projektowania dostawcy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-205">This propagates into the provider design-time packages.</span></span> <span data-ttu-id="c3fb8-206">Te pakiety (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, itp.) zostały usunięte i ich zawartość skonsolidowane w pakiety główne dostawcy.</span><span class="sxs-lookup"><span data-stu-id="c3fb8-206">Those packages (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, etc.) were removed and their contents consolidated into the main provider packages.</span></span>

<span data-ttu-id="c3fb8-207">Aby włączyć `Scaffold-DbContext` lub `dotnet ef dbcontext scaffold` w programie EF Core 2.0 wystarczy odwołują się do jednego dostawcy pakietu:</span><span class="sxs-lookup"><span data-stu-id="c3fb8-207">To enable `Scaffold-DbContext` or `dotnet ef dbcontext scaffold` in EF Core 2.0, you only need to reference the single provider package:</span></span>

``` xml
<PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer"
    Version="2.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools"
    Version="2.0.0"
    PrivateAssets="All" />
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet"
    Version="2.0.0" />
```
