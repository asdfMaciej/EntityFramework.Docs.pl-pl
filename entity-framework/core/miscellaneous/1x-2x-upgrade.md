---
title: "Uaktualnianie z poprzedniej wersji EF 2 rdzeni — rdzenie EF"
author: divega
ms.author: divega
ms.date: 8/13/2017
ms.assetid: 8BD43C8C-63D9-4F3A-B954-7BC518A1B7DB
ms.technology: entity-framework-core
uid: core/miscellaneous/1x-2x-upgrade
ms.openlocfilehash: 380f27c9f00943a2909ec7b876e151572a67dc37
ms.sourcegitcommit: ced2637bf8cc5964c6daa6c7fcfce501bf9ef6e8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="upgrading-applications-from-previous-versions-to-ef-core-20"></a><span data-ttu-id="b669f-102">Uaktualnianie aplikacji z poprzednich wersji 2.0 Core EF</span><span class="sxs-lookup"><span data-stu-id="b669f-102">Upgrading applications from previous versions to EF Core 2.0</span></span>

## <a name="procedures-common-to-all-applications"></a><span data-ttu-id="b669f-103">Procedury wspólne dla wszystkich aplikacji</span><span class="sxs-lookup"><span data-stu-id="b669f-103">Procedures Common to All Applications</span></span>

<span data-ttu-id="b669f-104">Aktualizowanie istniejącej aplikacji do EF Core 2.0 mogą wymagać:</span><span class="sxs-lookup"><span data-stu-id="b669f-104">Updating an existing application to EF Core 2.0 may require:</span></span>

1. <span data-ttu-id="b669f-105">Uaktualnianie platformy docelowej .NET do wersji obsługującej .NET 2.0 standardowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-105">Upgrading the target .NET platform of the application to one that supports .NET Standard 2.0.</span></span> <span data-ttu-id="b669f-106">Zobacz [obsługiwane platformy](../platforms/index.md) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="b669f-106">See [Supported Platforms](../platforms/index.md) for more details.</span></span>

2. <span data-ttu-id="b669f-107">Określ dostawcę dla docelowej bazy danych, które są zgodne z EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-107">Identify a provider for the target database which is compatible with EF Core 2.0.</span></span> <span data-ttu-id="b669f-108">Zobacz [EF Core 2.0 wymaga dostawcy bazy danych 2.0](#ef-core-20-requires-a-20-database-provider) poniżej.</span><span class="sxs-lookup"><span data-stu-id="b669f-108">See [EF Core 2.0 requires a 2.0 database provider](#ef-core-20-requires-a-20-database-provider) below.</span></span>

3. <span data-ttu-id="b669f-109">Uaktualnienie wszystkich pakietów EF Core (środowisko wykonawcze i narzędziami) 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-109">Upgrading all the EF Core packages (runtime and tooling) to 2.0.</span></span> <span data-ttu-id="b669f-110">Zapoznaj się [instalowanie Core EF](../get-started/install/index.md) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="b669f-110">Refer to [Installing EF Core](../get-started/install/index.md) for more details.</span></span>

4. <span data-ttu-id="b669f-111">Zmiany kodu niezbędne do kompensacji fundamentalne zmiany.</span><span class="sxs-lookup"><span data-stu-id="b669f-111">Make any necessary code changes to compensate for breaking changes.</span></span> <span data-ttu-id="b669f-112">Zobacz [fundamentalne zmiany](#breaking-changes) sekcji poniżej, aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-112">See the [Breaking Changes](#breaking-changes) section below for more details.</span></span>

## <a name="aspnet-core-applications"></a><span data-ttu-id="b669f-113">Aplikacje platformy ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="b669f-113">ASP.NET Core applications</span></span>

1. <span data-ttu-id="b669f-114">W szczególności zobacz [nowy wzorzec do inicjowania dostawcy usług aplikacji](#new-way-of-getting-application-services) opisane poniżej.</span><span class="sxs-lookup"><span data-stu-id="b669f-114">See in particular the [new pattern for initializing the application's service provider](#new-way-of-getting-application-services) described below.</span></span>

> [!TIP]  
> <span data-ttu-id="b669f-115">Przyjęcie ten nowy wzorzec podczas aktualizacji aplikacji 2.0 zdecydowanie zaleca się i jest wymagane dla produktu funkcji, takich jak Entity Framework Core migracji do pracy.</span><span class="sxs-lookup"><span data-stu-id="b669f-115">The adoption of this new pattern when updating applications to 2.0 is highly recommended and is required in order for product features like Entity Framework Core Migrations to work.</span></span> <span data-ttu-id="b669f-116">Inne typowe alternatywą jest [zaimplementować *IDesignTimeDbContextFactory\<TContext >*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span><span class="sxs-lookup"><span data-stu-id="b669f-116">The other common alternative is to [implement *IDesignTimeDbContextFactory\<TContext>*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span></span>

2. <span data-ttu-id="b669f-117">Aplikacji przeznaczonych dla platformy ASP.NET Core 2.0 służy EF Core 2.0 bez dodatkowe zależności oprócz dostawcy bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b669f-117">Applications targeting ASP.NET Core 2.0 can use EF Core 2.0 without additional dependencies besides third party database providers.</span></span> <span data-ttu-id="b669f-118">Jednak aplikacji na poprzednie wersje platformy ASP.NET Core konieczność uaktualnienia do programu ASP.NET 2.0 Core aby można było używać EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-118">However, applications targeting previous versions of ASP.NET Core need to upgrade to ASP.NET Core 2.0 in order to use EF Core 2.0.</span></span> <span data-ttu-id="b669f-119">Więcej informacji na temat uaktualniania aplikacji platformy ASP.NET Core 2.0 można znaleźć [dokumentacji platformy ASP.NET Core w sprawie](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span><span class="sxs-lookup"><span data-stu-id="b669f-119">For more details on upgrading ASP.NET Core applications to 2.0 see [the ASP.NET Core documentation on the subject](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span></span>

## <a name="breaking-changes"></a><span data-ttu-id="b669f-120">Fundamentalne zmiany</span><span class="sxs-lookup"><span data-stu-id="b669f-120">Breaking Changes</span></span>

<span data-ttu-id="b669f-121">Przekierowaliśmy możliwość znacznie uściślić naszych istniejących interfejsów API i zachowania w 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-121">We have taken the opportunity to significantly refine our existing APIs and behaviors in 2.0.</span></span> <span data-ttu-id="b669f-122">Istnieje kilka ulepszeń, które mogą wymagać modyfikacji istniejącego kodu aplikacji, mimo że uważamy, że dla większości aplikacji wpływ będzie niskie, w większości przypadków wymagających tylko kompilację i minimalne zmiany z przewodnikiem, aby zamienić przestarzałe interfejsy API.</span><span class="sxs-lookup"><span data-stu-id="b669f-122">There are a few improvements that can require modifying existing application code, although we believe that for the majority of applications the impact will be low, in most cases requiring just recompilation and minimal guided changes to replace obsolete APIs.</span></span>

### <a name="new-way-of-getting-application-services"></a><span data-ttu-id="b669f-123">Nowy sposób pobierania usługi aplikacji</span><span class="sxs-lookup"><span data-stu-id="b669f-123">New way of getting application services</span></span>

<span data-ttu-id="b669f-124">Wzorzec zalecanym dla aplikacji sieci web platformy ASP.NET Core została zaktualizowana 2.0 w taki sposób, aby spowodowało przerwanie EF Core używane w 1.x logiki czasu projektowania.</span><span class="sxs-lookup"><span data-stu-id="b669f-124">The recommended pattern for ASP.NET Core web applications has been updated for 2.0 in a way that broke the design-time logic EF Core used in 1.x.</span></span> <span data-ttu-id="b669f-125">Wcześniej w czasie projektowania, EF Core może spróbować wywołania `Startup.ConfigureServices` bezpośrednio w celu uzyskania dostępu do dostawcy usług aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-125">Previously at design-time, EF Core would try to invoke `Startup.ConfigureServices` directly in order to access the application's service provider.</span></span> <span data-ttu-id="b669f-126">W programie ASP.NET 2.0 Core, konfiguracja jest inicjowana poza `Startup` klasy.</span><span class="sxs-lookup"><span data-stu-id="b669f-126">In ASP.NET Core 2.0, Configuration is initialized outside of the `Startup` class.</span></span> <span data-ttu-id="b669f-127">Aplikacji przy użyciu EF Core zwykle dostęp do ich parametry połączenia z konfiguracji, więc `Startup` samodzielnie nie jest już wystarczające.</span><span class="sxs-lookup"><span data-stu-id="b669f-127">Applications using EF Core typically access their connection string from Configuration, so `Startup` by itself is no longer sufficient.</span></span> <span data-ttu-id="b669f-128">W przypadku uaktualniania aplikacji platformy ASP.NET Core 1.x następujący błąd może zostać wyświetlony podczas korzystania z narzędzi EF Core.</span><span class="sxs-lookup"><span data-stu-id="b669f-128">If you upgrade an ASP.NET Core 1.x application, you may receive the following error when using the EF Core tools.</span></span>

> <span data-ttu-id="b669f-129">W "ApplicationContext" został znaleziony żaden konstruktor bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="b669f-129">No parameterless constructor was found on 'ApplicationContext'.</span></span> <span data-ttu-id="b669f-130">Dodaj konstruktor bez parametrów do "ApplicationContext" albo Dodaj implementację "IDesignTimeDbContextFactory&lt;ApplicationContext&gt;" w tym samym zestawie co "ApplicationContext"</span><span class="sxs-lookup"><span data-stu-id="b669f-130">Either add a parameterless constructor to 'ApplicationContext' or add an implementation of 'IDesignTimeDbContextFactory&lt;ApplicationContext&gt;' in the same assembly as 'ApplicationContext'</span></span>

<span data-ttu-id="b669f-131">Nowe haku czasu projektowania został dodany w szablonie domyślnego platformy ASP.NET Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-131">A new design-time hook has been added in ASP.NET Core 2.0's default template.</span></span> <span data-ttu-id="b669f-132">Statycznych `Program.BuildWebHost` metoda zapewnia podstawowe EF można uzyskać dostępu do aplikacji dostawcy usług w czasie projektowania.</span><span class="sxs-lookup"><span data-stu-id="b669f-132">The static `Program.BuildWebHost` method enables EF Core to access the application's service provider at design time.</span></span> <span data-ttu-id="b669f-133">Jeśli uaktualniasz aplikacji platformy ASP.NET Core 1.x, konieczne będzie informować Cię o `Program` klasy na podobny do następującego.</span><span class="sxs-lookup"><span data-stu-id="b669f-133">If you are upgrading an ASP.NET Core 1.x application, you will need to update you `Program` class to resemble the following.</span></span>

``` csharp
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;

namespace AspNetCoreDotNetCore2._0App
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =>
            WebHost.CreateDefaultBuilder(args)
                .UseStartup<Startup>()
                .Build();
    }
}
```

### <a name="idbcontextfactory-renamed"></a><span data-ttu-id="b669f-134">Interfejsu IDbContextFactory zmieniona</span><span class="sxs-lookup"><span data-stu-id="b669f-134">IDbContextFactory renamed</span></span>

<span data-ttu-id="b669f-135">Aby można było obsługiwać wzorce różnych aplikacji i zapewniają użytkownikom większą kontrolę nad jak ich `DbContext` jest używany w czasie projektowania, udostępniamy, w przeszłości `IDbContextFactory<TContext>` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b669f-135">In order to support diverse application patterns and give users more control over how their `DbContext` is used at design time, we have, in the past, provided the `IDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="b669f-136">W czasie projektowania, EF podstawowe narzędzia odnajdzie implementacje tego interfejsu w projekcie i umożliwia utworzenie `DbContext` obiektów.</span><span class="sxs-lookup"><span data-stu-id="b669f-136">At design-time, the EF Core tools will discover implementations of this interface in your project and use it to create `DbContext` objects.</span></span>

<span data-ttu-id="b669f-137">Ten interfejs ma bardzo ogólne nazwę, która błąd w przypadku niektórych użytkowników, aby spróbować ponownie przy użyciu dla innych `DbContext`— tworzenie scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="b669f-137">This interface had a very general name which mislead some users to try re-using it for other `DbContext`-creating scenarios.</span></span> <span data-ttu-id="b669f-138">Zostały przechwycono poza guard, gdy narzędzia EF następnie próbowano użyć ich implementacji w czasie projektowania i spowodował poleceń, takich jak `Update-Database` lub `dotnet ef database update` się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="b669f-138">They were caught off guard when the EF Tools then tried to use their implementation at design-time and caused commands like `Update-Database` or `dotnet ef database update` to fail.</span></span>

<span data-ttu-id="b669f-139">Aby komunikować się silne semantykę czasu projektowania ten interfejs, możemy zmieniono jego `IDesignTimeDbContextFactory<TContext>`.</span><span class="sxs-lookup"><span data-stu-id="b669f-139">In order to communicate the strong design-time semantics of this interface, we have renamed it to `IDesignTimeDbContextFactory<TContext>`.</span></span>

<span data-ttu-id="b669f-140">2.0 wersji `IDbContextFactory<TContext>` nadal istnieje, ale jest oznaczony jako przestarzały.</span><span class="sxs-lookup"><span data-stu-id="b669f-140">For the 2.0 release the `IDbContextFactory<TContext>` still exists but is marked as obsolete.</span></span>

### <a name="dbcontextfactoryoptions-removed"></a><span data-ttu-id="b669f-141">DbContextFactoryOptions usunięte</span><span class="sxs-lookup"><span data-stu-id="b669f-141">DbContextFactoryOptions removed</span></span>

<span data-ttu-id="b669f-142">Ze względu na zmiany ASP.NET Core 2.0, opisane powyżej, który znaleziono `DbContextFactoryOptions` został już potrzebne na nowym `IDesignTimeDbContextFactory<TContext>` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b669f-142">Because of the ASP.NET Core 2.0 changes described above, we found that `DbContextFactoryOptions` was no longer needed on the new `IDesignTimeDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="b669f-143">Poniżej przedstawiono opis rozwiązań alternatywnych, który powinien być używany zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="b669f-143">Here are the alternatives you should be using instead.</span></span>

<span data-ttu-id="b669f-144">DbContextFactoryOptions</span><span class="sxs-lookup"><span data-stu-id="b669f-144">DbContextFactoryOptions</span></span> | <span data-ttu-id="b669f-145">Alternatywne</span><span class="sxs-lookup"><span data-stu-id="b669f-145">Alternative</span></span>
--- | ---
<span data-ttu-id="b669f-146">ApplicationBasePath</span><span class="sxs-lookup"><span data-stu-id="b669f-146">ApplicationBasePath</span></span> | <span data-ttu-id="b669f-147">AppContext.BaseDirectory</span><span class="sxs-lookup"><span data-stu-id="b669f-147">AppContext.BaseDirectory</span></span>
<span data-ttu-id="b669f-148">ContentRootPath</span><span class="sxs-lookup"><span data-stu-id="b669f-148">ContentRootPath</span></span> | <span data-ttu-id="b669f-149">Directory.GetCurrentDirectory()</span><span class="sxs-lookup"><span data-stu-id="b669f-149">Directory.GetCurrentDirectory()</span></span>
<span data-ttu-id="b669f-150">EnvironmentName</span><span class="sxs-lookup"><span data-stu-id="b669f-150">EnvironmentName</span></span> | <span data-ttu-id="b669f-151">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span><span class="sxs-lookup"><span data-stu-id="b669f-151">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span></span>

### <a name="design-time-working-directory-changed"></a><span data-ttu-id="b669f-152">Katalog roboczy czasu projektowania zmienione</span><span class="sxs-lookup"><span data-stu-id="b669f-152">Design-time working directory changed</span></span>

<span data-ttu-id="b669f-153">Zmiany platformy ASP.NET Core 2.0 wymaga również katalog roboczy używany przez `dotnet ef` , aby były wyrównane z katalogu roboczego używany przez Visual Studio podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-153">The ASP.NET Core 2.0 changes also required the working directory used by `dotnet ef` to align with the working directory used by Visual Studio when running your application.</span></span> <span data-ttu-id="b669f-154">Jeden zauważalne efektem ubocznym tego jest tym SQLite nazwy plików są teraz względem katalogu projektu i nie do katalogu wyjściowego tak jak kiedyś.</span><span class="sxs-lookup"><span data-stu-id="b669f-154">One observable side effect of this is that SQLite filenames are now relative to the project directory and not the output directory like they used to be.</span></span>

### <a name="ef-core-20-requires-a-20-database-provider"></a><span data-ttu-id="b669f-155">Podstawowe EF 2.0 wymaga dostawcy 2.0 bazy danych</span><span class="sxs-lookup"><span data-stu-id="b669f-155">EF Core 2.0 requires a 2.0 database provider</span></span>

<span data-ttu-id="b669f-156">EF Core 2.0 wprowadzono wiele uproszczenia i ulepszenia w sposób dostawcy bazy danych działa.</span><span class="sxs-lookup"><span data-stu-id="b669f-156">For EF Core 2.0 we have made many simplifications and improvements in the way database providers work.</span></span> <span data-ttu-id="b669f-157">Oznacza to, 1.0.x i 1.1.x dostawcy nie będą działać z EF Core 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-157">This means that 1.0.x and 1.1.x providers will not work with EF Core 2.0.</span></span>

<span data-ttu-id="b669f-158">Dostawcy programu SQL Server i bazy danych SQLite są dostarczane przez zespół EF i wersje 2.0 będą dostępne jako część programu 2.0 wersji.</span><span class="sxs-lookup"><span data-stu-id="b669f-158">The SQL Server and SQLite providers are shipped by the EF team and 2.0 versions will be available as part of the 2.0 release.</span></span> <span data-ttu-id="b669f-159">Dla dostawców innej open source [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), i [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) są aktualizowane 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-159">The open-source third party providers for [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), and [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) are being updated for 2.0.</span></span> <span data-ttu-id="b669f-160">Dla wszystkich innych dostawców skontaktuj się z modułu zapisującego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="b669f-160">For all other providers, please contact the provider writer.</span></span>

### <a name="logging-and-diagnostics-events-have-changed"></a><span data-ttu-id="b669f-161">Zmieniono zdarzenia rejestrowania i diagnostyki</span><span class="sxs-lookup"><span data-stu-id="b669f-161">Logging and Diagnostics events have changed</span></span>

<span data-ttu-id="b669f-162">Uwaga: te zmiany nie powinny mieć wpływ większość kodu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-162">Note: these changes should not impact most application code.</span></span>

<span data-ttu-id="b669f-163">Identyfikatory zdarzeń komunikatów wysyłanych do [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) zostały zmienione w 2.0.</span><span class="sxs-lookup"><span data-stu-id="b669f-163">The event IDs for messages sent to an [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) have changed in 2.0.</span></span> <span data-ttu-id="b669f-164">Identyfikatory zdarzeń obecnie są unikatowe w EF rdzeń kodu.</span><span class="sxs-lookup"><span data-stu-id="b669f-164">The event IDs are now unique across EF Core code.</span></span> <span data-ttu-id="b669f-165">Te komunikaty teraz również wykonać standardowego wzorca strukturalnych rejestrowania używany przez, na przykład MVC.</span><span class="sxs-lookup"><span data-stu-id="b669f-165">These messages now also follow the standard pattern for structured logging used by, for example, MVC.</span></span>

<span data-ttu-id="b669f-166">Kategorie rejestratora również zostały zmienione.</span><span class="sxs-lookup"><span data-stu-id="b669f-166">Logger categories have also changed.</span></span> <span data-ttu-id="b669f-167">Ma teraz dobrze znanego zestawu kategorii dostępne za pośrednictwem [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs).</span><span class="sxs-lookup"><span data-stu-id="b669f-167">There is now a well-known set of categories accessed through [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs).</span></span>

<span data-ttu-id="b669f-168">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) zdarzenia teraz użyć tej samej nazwy Identyfikatora zdarzenia odpowiadającego `ILogger` wiadomości.</span><span class="sxs-lookup"><span data-stu-id="b669f-168">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) events now use the same event ID names as the corresponding `ILogger` messages.</span></span> <span data-ttu-id="b669f-169">Ładunki zdarzeń są wszystkie nominalnego typów pochodnych [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span><span class="sxs-lookup"><span data-stu-id="b669f-169">The event payloads are all nominal types derived from [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span></span>

<span data-ttu-id="b669f-170">Identyfikatory zdarzeń, typy ładunku i kategorie są udokumentowane w artykule [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) i [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) klasy.</span><span class="sxs-lookup"><span data-stu-id="b669f-170">Event IDs, payload types, and categories are documented in the [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) and the [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) classes.</span></span>

<span data-ttu-id="b669f-171">Identyfikatory również został przeniesiony z Microsoft.EntityFrameworkCore.Infraestructure nowej Microsoft.EntityFrameworkCore.Diagnostics przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="b669f-171">IDs have also moved from Microsoft.EntityFrameworkCore.Infraestructure to the new Microsoft.EntityFrameworkCore.Diagnostics namespace.</span></span>

### <a name="ef-core-relational-metadata-api-changes"></a><span data-ttu-id="b669f-172">Zmiany relacyjne metadanych interfejsu API Core EF</span><span class="sxs-lookup"><span data-stu-id="b669f-172">EF Core relational metadata API changes</span></span>

<span data-ttu-id="b669f-173">Podstawowe EF 2.0 teraz kompilacji w innej [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs) dla każdego używanego innego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="b669f-173">EF Core 2.0 will now build a different [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs) for each different provider being used.</span></span> <span data-ttu-id="b669f-174">Jest to zazwyczaj niewidoczne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-174">This is usually transparent to the application.</span></span> <span data-ttu-id="b669f-175">Ma to ułatwić uproszczenia metadanych niższego poziomu interfejsów API tak, aby wszelkie dostęp do _wspólne pojęcia relacyjne metadanych_ jest zawsze wykonywane za pośrednictwem wywołania `.Relational` zamiast `.SqlServer`, `.Sqlite`itp. Na przykład 1.1.x kod następująco:</span><span class="sxs-lookup"><span data-stu-id="b669f-175">This has facilitated a simplification of lower-level metadata APIs such that any access to _common relational metadata concepts_ is always made through a call to `.Relational` instead of `.SqlServer`, `.Sqlite`, etc. For example, 1.1.x code like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).SqlServer().TableName;
```

<span data-ttu-id="b669f-176">Powinny teraz być zapisany jako:</span><span class="sxs-lookup"><span data-stu-id="b669f-176">Should now be written like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).Relational().TableName;
```

<span data-ttu-id="b669f-177">Zamiast metody, takie jak `ForSqlServerToTable`, metody rozszerzenia są teraz dostępne do zapisu warunkowego kodu opartego na bieżącym dostawcy używany.</span><span class="sxs-lookup"><span data-stu-id="b669f-177">Instead of using methods like `ForSqlServerToTable`, extension methods are now available to write conditional code based on the current provider in use.</span></span> <span data-ttu-id="b669f-178">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="b669f-178">For example:</span></span>

```C#
modelBuilder.Entity<User>().ToTable(
    Database.IsSqlServer() ? "SqlServerName" : "OtherName");
```

<span data-ttu-id="b669f-179">Należy pamiętać, że ta zmiana ma zastosowanie tylko do interfejsów API/metadanych, który jest zdefiniowany dla _wszystkie_ relacyjne dostawców.</span><span class="sxs-lookup"><span data-stu-id="b669f-179">Note that this change only applies to APIs/metadata that is defined for _all_ relational providers.</span></span> <span data-ttu-id="b669f-180">Interfejs API i metadanych jest taka sama, gdy nie jest specyficzne dla tylko jednego dostawcę.</span><span class="sxs-lookup"><span data-stu-id="b669f-180">The API and metadata remains the same when it is specific to only a single provider.</span></span> <span data-ttu-id="b669f-181">Na przykład indeksy klastrowane są specyficzne dla programu SQL Server, dlatego `ForSqlServerIsClustered` i `.SqlServer().IsClustered()` musi być używany.</span><span class="sxs-lookup"><span data-stu-id="b669f-181">For example, clustered indexes are specific to SQL Sever, so `ForSqlServerIsClustered` and  `.SqlServer().IsClustered()` must still be used.</span></span>

### <a name="dont-take-control-of-the-ef-service-provider"></a><span data-ttu-id="b669f-182">Nie przejąć kontrolę nad dostawca programu EF usługi</span><span class="sxs-lookup"><span data-stu-id="b669f-182">Don’t take control of the EF service provider</span></span>

<span data-ttu-id="b669f-183">Podstawowe EF używa wewnętrznego `IServiceProvider` (tj. kontener iniekcji zależności) do jego wewnętrznej implementacji.</span><span class="sxs-lookup"><span data-stu-id="b669f-183">EF Core uses an internal `IServiceProvider` (i.e. a dependency injection container) for its internal implementation.</span></span> <span data-ttu-id="b669f-184">Aplikacje powinna zezwalać na podstawowe EF tworzenie i zarządzanie nimi ten dostawca, z wyjątkiem w szczególnych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="b669f-184">Applications should allow EF Core to create and manage this provider except in special cases.</span></span> <span data-ttu-id="b669f-185">Zdecydowanie Rozważ usunięcie wszelkie wywołania `UseInternalServiceProvider`.</span><span class="sxs-lookup"><span data-stu-id="b669f-185">Strongly consider removing any calls to `UseInternalServiceProvider`.</span></span> <span data-ttu-id="b669f-186">Jeśli aplikacja musi wywołać `UseInternalServiceProvider`, należy rozważyć [składanie problemu](https://github.com/aspnet/EntityFramework/Issues) tak zbadanie inne sposoby obsługi danego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="b669f-186">If an application does need to call `UseInternalServiceProvider`, then please consider [filing an issue](https://github.com/aspnet/EntityFramework/Issues) so we can investigate other ways to handle your scenario.</span></span>

<span data-ttu-id="b669f-187">Wywoływanie `AddEntityFramework`, `AddEntityFrameworkSqlServer`, itp. nie jest wymagane przez kod aplikacji, chyba że `UseInternalServiceProvider` skrót.</span><span class="sxs-lookup"><span data-stu-id="b669f-187">Calling `AddEntityFramework`, `AddEntityFrameworkSqlServer`, etc. is not required by application code unless `UseInternalServiceProvider` is also called.</span></span> <span data-ttu-id="b669f-188">Usuń istniejące połączenia do `AddEntityFramework` lub `AddEntityFrameworkSqlServer`, itd. `AddDbContext` nadal stosuje się w taki sam sposób jak wcześniej.</span><span class="sxs-lookup"><span data-stu-id="b669f-188">Remove any existing calls to `AddEntityFramework` or `AddEntityFrameworkSqlServer`, etc. `AddDbContext` should still be used in the same way as before.</span></span>

### <a name="in-memory-databases-must-be-named"></a><span data-ttu-id="b669f-189">Musi mieć nazwę bazy danych w pamięci</span><span class="sxs-lookup"><span data-stu-id="b669f-189">In-memory databases must be named</span></span>

<span data-ttu-id="b669f-190">Globalne bez nazwy bazy danych w pamięci została usunięta i zamiast tego wszystkie bazy danych w pamięci musi mieć nazwę.</span><span class="sxs-lookup"><span data-stu-id="b669f-190">The global unnamed in-memory database has been removed and instead all in-memory databases must be named.</span></span> <span data-ttu-id="b669f-191">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="b669f-191">For example:</span></span>

``` csharp
optionsBuilder.UseInMemoryDatabase("MyDatabase");
```

<span data-ttu-id="b669f-192">To tworzy/używa bazy danych o nazwie "Mojabazadanych".</span><span class="sxs-lookup"><span data-stu-id="b669f-192">This creates/uses a database with the name “MyDatabase”.</span></span> <span data-ttu-id="b669f-193">Jeśli `UseInMemoryDatabase` nie zostanie ponownie wywołany o takiej samej nazwie, a następnie można użyć tej samej bazy danych w pamięci, dzięki któremu być współużytkowane przez wiele wystąpień kontekstu.</span><span class="sxs-lookup"><span data-stu-id="b669f-193">If `UseInMemoryDatabase` is called again with the same name, then the same in-memory database will be used, allowing it to be shared by multiple context instances.</span></span>

### <a name="read-only-api-changes"></a><span data-ttu-id="b669f-194">Zmiany interfejsu API tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="b669f-194">Read-only API changes</span></span>

<span data-ttu-id="b669f-195">`IsReadOnlyBeforeSave`, `IsReadOnlyAferSave`, i `IsStoreGeneratedAlways` zostały zdezaktualizowane i zastąpione [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) i [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span><span class="sxs-lookup"><span data-stu-id="b669f-195">`IsReadOnlyBeforeSave`, `IsReadOnlyAferSave`, and `IsStoreGeneratedAlways` have been obsoleted and replaced with [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) and [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span></span> <span data-ttu-id="b669f-196">Te zachowania zastosowania do żadnej właściwości (nie tylko generowanych przez Magazyn właściwości) i określić jak wartość właściwości powinien być używany podczas wstawiania do wiersza bazy danych (`BeforeSaveBehavior`) lub gdy aktualizacja istniejącej bazy danych wiersza (`AfterSaveBehavior`).</span><span class="sxs-lookup"><span data-stu-id="b669f-196">These behaviors apply to any property (not only store-generated properties) and determine how the value of the property should be used when inserting into a database row (`BeforeSaveBehavior`) or when updating an existing database row (`AfterSaveBehavior`).</span></span>

<span data-ttu-id="b669f-197">Właściwości oznaczone jako [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (np. dla kolumny obliczanej) domyślnie zignoruje wartości aktualnie ustawione na właściwość.</span><span class="sxs-lookup"><span data-stu-id="b669f-197">Properties marked as [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (e.g. for computed columns) will by default ignore any value currently set on the property.</span></span> <span data-ttu-id="b669f-198">Oznacza to, generowanych przez Magazyn wartość zawsze będzie można uzyskać niezależnie od tego, czy wartości został ustawiony lub zmodyfikowany śledzonych jednostki.</span><span class="sxs-lookup"><span data-stu-id="b669f-198">This means that a store-generated value will always be obtained regardless of whether any value has been set or modified on the tracked entity.</span></span> <span data-ttu-id="b669f-199">Można to zmienić, ustawiając innej `Before\AfterSaveBehavior`.</span><span class="sxs-lookup"><span data-stu-id="b669f-199">This can be changed by setting a different `Before\AfterSaveBehavior`.</span></span>

### <a name="new-clientsetnull-delete-behavior"></a><span data-ttu-id="b669f-200">Nowe zachowanie delete ClientSetNull</span><span class="sxs-lookup"><span data-stu-id="b669f-200">New ClientSetNull delete behavior</span></span>

<span data-ttu-id="b669f-201">W poprzednich wersjach [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) miał zachowania jednostek śledzone przez kontekst, jeden zamknięty dopasowane `SetNull` semantyki.</span><span class="sxs-lookup"><span data-stu-id="b669f-201">In previous releases, [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) had a behavior for entities tracked by the context that more closed matched `SetNull` semantics.</span></span> <span data-ttu-id="b669f-202">W programie EF Core 2.0 nowy `ClientSetNull` zachowanie została wprowadzona jako domyślny dla relacji opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="b669f-202">In EF Core 2.0, a new `ClientSetNull` behavior has been introduced as the default for optional relationships.</span></span> <span data-ttu-id="b669f-203">Jest to zachowanie `SetNull` semantyki dla śledzonych jednostek i `Restrict` zachowanie dla baz danych utworzonych przy użyciu EF Core.</span><span class="sxs-lookup"><span data-stu-id="b669f-203">This behavior has `SetNull` semantics for tracked entities and `Restrict` behavior for databases created using EF Core.</span></span> <span data-ttu-id="b669f-204">W naszym środowisku są oczekiwano/użyteczna zachowania śledzonych obiektów i bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b669f-204">In our experience, these are the most expected/useful behaviors for tracked entities and the database.</span></span> <span data-ttu-id="b669f-205">`DeleteBehavior.Restrict`teraz jest honorowane dla śledzonych jednostek po ustawieniu dla relacji opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="b669f-205">`DeleteBehavior.Restrict` is now honored for tracked entities when set for optional relationships.</span></span>

### <a name="provider-design-time-packages-removed"></a><span data-ttu-id="b669f-206">Dostawca czasu projektowania pakietów usunięte</span><span class="sxs-lookup"><span data-stu-id="b669f-206">Provider design-time packages removed</span></span>

<span data-ttu-id="b669f-207">`Microsoft.EntityFrameworkCore.Relational.Design` Pakiet został usunięty.</span><span class="sxs-lookup"><span data-stu-id="b669f-207">The `Microsoft.EntityFrameworkCore.Relational.Design` package has been removed.</span></span> <span data-ttu-id="b669f-208">Jego zawartości są konsolidowane w `Microsoft.EntityFrameworkCore.Relational` i `Microsoft.EntityFrameworkCore.Design`.</span><span class="sxs-lookup"><span data-stu-id="b669f-208">It's contents were consolidated into `Microsoft.EntityFrameworkCore.Relational` and `Microsoft.EntityFrameworkCore.Design`.</span></span>

<span data-ttu-id="b669f-209">Propaguje to do dostawcy pakietów czasu projektowania.</span><span class="sxs-lookup"><span data-stu-id="b669f-209">This propagates into the provider design-time packages.</span></span> <span data-ttu-id="b669f-210">Te pakiety (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, itd.) zostały usunięte i ich zawartość do pakietów głównego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="b669f-210">Those packages (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, etc.) were removed and their contents consolidated into the main provider packages.</span></span>

<span data-ttu-id="b669f-211">Aby włączyć `Scaffold-DbContext` lub `dotnet ef dbcontext scaffold` w programie EF Core 2.0, wystarczy odwołują się do jednego dostawcy pakietu:</span><span class="sxs-lookup"><span data-stu-id="b669f-211">To enable `Scaffold-DbContext` or `dotnet ef dbcontext scaffold` in EF Core 2.0, you only need to reference the single provider package:</span></span>

``` xml
<PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer"
    Version="2.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools"
    Version="2.0.0"
    PrivateAssets="All" />
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet"
    Version="2.0.0" />
```
